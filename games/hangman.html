<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hangman - Game Arcade</title>
    <link rel="stylesheet" href="../css/styles.css">
    <style>
        .hangman-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }
        .hangman-figure {
            font-family: monospace;
            font-size: 1.1rem;
            line-height: 1.3;
            white-space: pre;
            color: var(--text-secondary);
            background: var(--dark-bg);
            padding: 20px 40px;
            border-radius: 10px;
            min-height: 180px;
        }
        .word-display {
            font-size: 2.5rem;
            letter-spacing: 15px;
            font-weight: 700;
            margin: 20px 0;
            text-transform: uppercase;
        }
        .word-display .letter {
            display: inline-block;
            min-width: 30px;
            border-bottom: 4px solid var(--text-primary);
            margin: 5px;
            padding-bottom: 5px;
        }
        .word-display .letter.revealed {
            color: var(--primary-color);
        }
        .word-display .space {
            min-width: 20px;
            border-bottom: none;
        }
        .keyboard {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
            max-width: 550px;
        }
        .key {
            width: 44px;
            height: 50px;
            border: none;
            border-radius: 8px;
            background: var(--dark-bg);
            color: var(--text-primary);
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        .key:hover:not(:disabled) {
            background: var(--primary-color);
            transform: translateY(-2px);
        }
        .key:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        .key.correct {
            background: var(--success-color);
            color: white;
        }
        .key.wrong {
            background: var(--danger-color);
            color: white;
        }
        .hint-area {
            background: var(--dark-bg);
            padding: 15px 25px;
            border-radius: 10px;
            color: var(--text-secondary);
        }
        .hint-area strong {
            color: var(--warning-color);
        }
        .category-selection {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }
        .category-btn {
            padding: 10px 20px;
            border: 1px solid var(--border-color);
            background: var(--card-bg);
            color: var(--text-primary);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .category-btn:hover {
            border-color: var(--primary-color);
        }
        .category-btn.active {
            background: var(--primary-color);
            border-color: var(--primary-color);
        }
        .word-input {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
        }
        .word-input input {
            flex: 1;
            min-width: 200px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="game-header">
            <h1>Hangman</h1>
            <a href="../index.html" class="back-btn">&#8592; Back to Games</a>
        </div>

        <div id="setup" class="game-container">
            <h2 style="text-align: center; margin-bottom: 20px;">Select Game Mode</h2>

            <div class="mode-selection">
                <button class="mode-btn active" data-mode="ai">vs Computer</button>
                <button class="mode-btn" data-mode="pvp">2 Players</button>
            </div>

            <div id="categorySection" style="margin-top: 20px;">
                <h3 style="text-align: center; margin-bottom: 15px;">Select Category</h3>
                <div class="category-selection">
                    <button class="category-btn active" data-category="animals">Animals</button>
                    <button class="category-btn" data-category="countries">Countries</button>
                    <button class="category-btn" data-category="movies">Movies</button>
                    <button class="category-btn" data-category="food">Food</button>
                    <button class="category-btn" data-category="sports">Sports</button>
                    <button class="category-btn" data-category="random">Random</button>
                </div>
            </div>

            <div id="pvpWordSection" style="margin-top: 20px; display: none;">
                <h3 style="text-align: center; margin-bottom: 15px;">Enter Word for Opponent</h3>
                <div class="word-input">
                    <input type="text" id="customWord" placeholder="Enter a word or phrase..." maxlength="30">
                    <input type="text" id="customHint" placeholder="Hint (optional)" maxlength="50">
                </div>
            </div>

            <div class="btn-group" style="margin-top: 20px;">
                <button class="btn btn-success" onclick="startGame()">Start Game</button>
            </div>
        </div>

        <div id="game" class="game-container" style="display: none;">
            <div class="hangman-container">
                <div class="hangman-figure" id="figure"></div>

                <div class="hint-area" id="hintArea"></div>

                <div class="word-display" id="wordDisplay"></div>

                <div class="game-status" id="status">Guess a letter!</div>

                <div class="keyboard" id="keyboard"></div>
            </div>

            <div class="btn-group" style="margin-top: 20px;">
                <button class="btn" onclick="newGame()">New Word</button>
                <button class="btn btn-secondary" onclick="backToSetup()">Change Mode</button>
            </div>
        </div>

        <div class="game-container">
            <h3 style="margin-bottom: 15px;">Statistics</h3>
            <div id="stats"></div>
        </div>
    </div>

    <script src="../js/utils.js"></script>
    <script>
        // Word lists by category
        const wordLists = {
            animals: [
                { word: 'elephant', hint: 'Largest land animal' },
                { word: 'giraffe', hint: 'Tallest animal' },
                { word: 'penguin', hint: 'Flightless bird that loves cold' },
                { word: 'kangaroo', hint: 'Hops and has a pouch' },
                { word: 'dolphin', hint: 'Smart marine mammal' },
                { word: 'butterfly', hint: 'Beautiful flying insect' },
                { word: 'crocodile', hint: 'Ancient reptile with big jaws' },
                { word: 'octopus', hint: 'Eight-armed sea creature' },
                { word: 'cheetah', hint: 'Fastest land animal' },
                { word: 'flamingo', hint: 'Pink bird that stands on one leg' }
            ],
            countries: [
                { word: 'australia', hint: 'Land down under' },
                { word: 'brazil', hint: 'Home of the Amazon' },
                { word: 'japan', hint: 'Land of the rising sun' },
                { word: 'egypt', hint: 'Home of the pyramids' },
                { word: 'canada', hint: 'Known for maple syrup' },
                { word: 'germany', hint: 'Famous for beer and cars' },
                { word: 'mexico', hint: 'Land of tacos and mariachi' },
                { word: 'india', hint: 'Home of the Taj Mahal' },
                { word: 'italy', hint: 'Shaped like a boot' },
                { word: 'iceland', hint: 'Land of fire and ice' }
            ],
            movies: [
                { word: 'titanic', hint: 'Famous shipwreck romance' },
                { word: 'avatar', hint: 'Blue aliens on Pandora' },
                { word: 'inception', hint: 'Dreams within dreams' },
                { word: 'gladiator', hint: 'Roman warrior seeks revenge' },
                { word: 'frozen', hint: 'Let it go!' },
                { word: 'jaws', hint: 'Scary shark movie' },
                { word: 'matrix', hint: 'Red pill or blue pill' },
                { word: 'jurassic park', hint: 'Dinosaurs come back' },
                { word: 'finding nemo', hint: 'Lost clownfish' },
                { word: 'star wars', hint: 'In a galaxy far away' }
            ],
            food: [
                { word: 'pizza', hint: 'Italian flatbread with toppings' },
                { word: 'spaghetti', hint: 'Long pasta noodles' },
                { word: 'hamburger', hint: 'Ground beef sandwich' },
                { word: 'chocolate', hint: 'Sweet treat from cocoa' },
                { word: 'avocado', hint: 'Green fruit for guacamole' },
                { word: 'sushi', hint: 'Japanese rice and fish' },
                { word: 'pancakes', hint: 'Flat breakfast cakes' },
                { word: 'watermelon', hint: 'Large striped fruit' },
                { word: 'tacos', hint: 'Mexican folded tortillas' },
                { word: 'croissant', hint: 'Flaky French pastry' }
            ],
            sports: [
                { word: 'basketball', hint: 'Hoop and ball game' },
                { word: 'football', hint: 'Touchdown sport' },
                { word: 'swimming', hint: 'Pool competition' },
                { word: 'tennis', hint: 'Racket and net game' },
                { word: 'gymnastics', hint: 'Flips and balance beams' },
                { word: 'volleyball', hint: 'Hit ball over the net' },
                { word: 'skateboarding', hint: 'Tricks on a board' },
                { word: 'archery', hint: 'Bow and arrow sport' },
                { word: 'snowboarding', hint: 'Mountain winter sport' },
                { word: 'wrestling', hint: 'Grappling combat sport' }
            ]
        };

        // Hangman figure stages
        const hangmanStages = [
            `
  +---+
  |   |
      |
      |
      |
      |
=========`,
            `
  +---+
  |   |
  O   |
      |
      |
      |
=========`,
            `
  +---+
  |   |
  O   |
  |   |
      |
      |
=========`,
            `
  +---+
  |   |
  O   |
 /|   |
      |
      |
=========`,
            `
  +---+
  |   |
  O   |
 /|\\  |
      |
      |
=========`,
            `
  +---+
  |   |
  O   |
 /|\\  |
 /    |
      |
=========`,
            `
  +---+
  |   |
  O   |
 /|\\  |
 / \\  |
      |
=========`
        ];

        // Game state
        let currentWord = '';
        let currentHint = '';
        let guessedLetters = [];
        let wrongGuesses = 0;
        let gameActive = false;
        let gameMode = 'ai';
        let category = 'animals';
        let playerName;

        function init() {
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    gameMode = btn.dataset.mode;

                    document.getElementById('categorySection').style.display = gameMode === 'ai' ? 'block' : 'none';
                    document.getElementById('pvpWordSection').style.display = gameMode === 'pvp' ? 'block' : 'none';
                });
            });

            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    category = btn.dataset.category;
                });
            });

            // Keyboard input
            document.addEventListener('keydown', (e) => {
                if (gameActive && /^[a-zA-Z]$/.test(e.key)) {
                    guessLetter(e.key.toUpperCase());
                }
            });

            GameUtils.renderStats('hangman', 'stats');
        }

        function getRandomWord() {
            if (category === 'random') {
                const categories = Object.keys(wordLists);
                const randomCat = categories[Math.floor(Math.random() * categories.length)];
                const words = wordLists[randomCat];
                return words[Math.floor(Math.random() * words.length)];
            }
            const words = wordLists[category];
            return words[Math.floor(Math.random() * words.length)];
        }

        function startGame() {
            playerName = GameUtils.playerName.get(1);

            if (gameMode === 'pvp') {
                const customWord = document.getElementById('customWord').value.trim();
                if (!customWord) {
                    alert('Please enter a word!');
                    return;
                }
                currentWord = customWord.toUpperCase();
                currentHint = document.getElementById('customHint').value.trim() || 'No hint provided';
            } else {
                const wordData = getRandomWord();
                currentWord = wordData.word.toUpperCase();
                currentHint = wordData.hint;
            }

            guessedLetters = [];
            wrongGuesses = 0;
            gameActive = true;

            document.getElementById('setup').style.display = 'none';
            document.getElementById('game').style.display = 'block';

            renderGame();
        }

        function newGame() {
            if (gameMode === 'pvp') {
                backToSetup();
                return;
            }

            const wordData = getRandomWord();
            currentWord = wordData.word.toUpperCase();
            currentHint = wordData.hint;
            guessedLetters = [];
            wrongGuesses = 0;
            gameActive = true;

            renderGame();
        }

        function backToSetup() {
            document.getElementById('setup').style.display = 'block';
            document.getElementById('game').style.display = 'none';
            document.getElementById('customWord').value = '';
            document.getElementById('customHint').value = '';
        }

        function renderGame() {
            // Render hangman figure
            document.getElementById('figure').textContent = hangmanStages[wrongGuesses];

            // Render hint
            document.getElementById('hintArea').innerHTML = `<strong>Hint:</strong> ${currentHint}`;

            // Render word display
            let wordHtml = '';
            for (const char of currentWord) {
                if (char === ' ') {
                    wordHtml += '<span class="letter space"></span>';
                } else if (guessedLetters.includes(char)) {
                    wordHtml += `<span class="letter revealed">${char}</span>`;
                } else {
                    wordHtml += '<span class="letter"></span>';
                }
            }
            document.getElementById('wordDisplay').innerHTML = wordHtml;

            // Render keyboard
            const keyboard = document.getElementById('keyboard');
            keyboard.innerHTML = '';
            for (let i = 65; i <= 90; i++) {
                const letter = String.fromCharCode(i);
                const btn = document.createElement('button');
                btn.className = 'key';
                btn.textContent = letter;

                if (guessedLetters.includes(letter)) {
                    btn.disabled = true;
                    if (currentWord.includes(letter)) {
                        btn.classList.add('correct');
                    } else {
                        btn.classList.add('wrong');
                    }
                }

                btn.addEventListener('click', () => guessLetter(letter));
                keyboard.appendChild(btn);
            }

            // Update status
            updateStatus();
        }

        function guessLetter(letter) {
            if (!gameActive || guessedLetters.includes(letter)) return;

            guessedLetters.push(letter);

            if (!currentWord.includes(letter)) {
                wrongGuesses++;
            }

            renderGame();
            checkGameEnd();
        }

        function updateStatus() {
            const statusEl = document.getElementById('status');
            statusEl.classList.remove('winner');

            if (!gameActive) return;

            const remaining = 6 - wrongGuesses;
            statusEl.textContent = `Guesses remaining: ${remaining}`;
        }

        function checkGameEnd() {
            const wordLetters = [...new Set(currentWord.replace(/ /g, '').split(''))];
            const allGuessed = wordLetters.every(letter => guessedLetters.includes(letter));

            if (allGuessed) {
                // Win!
                gameActive = false;
                const statusEl = document.getElementById('status');
                statusEl.textContent = 'Congratulations! You won!';
                statusEl.classList.add('winner');

                GameUtils.stats.update('hangman', 'win');

                // Score based on remaining guesses
                const score = (6 - wrongGuesses) * 10 + currentWord.length;
                GameUtils.highScores.add('hangman', playerName, score, { word: currentWord, guesses: wrongGuesses });
                GameUtils.renderStats('hangman', 'stats');

            } else if (wrongGuesses >= 6) {
                // Lose!
                gameActive = false;
                const statusEl = document.getElementById('status');
                statusEl.textContent = `Game Over! The word was: ${currentWord}`;

                // Reveal the word
                let wordHtml = '';
                for (const char of currentWord) {
                    if (char === ' ') {
                        wordHtml += '<span class="letter space"></span>';
                    } else {
                        const color = guessedLetters.includes(char) ? 'revealed' : '';
                        wordHtml += `<span class="letter ${color}" style="${!guessedLetters.includes(char) ? 'color: var(--danger-color);' : ''}">${char}</span>`;
                    }
                }
                document.getElementById('wordDisplay').innerHTML = wordHtml;

                GameUtils.stats.update('hangman', 'loss');
                GameUtils.renderStats('hangman', 'stats');
            }
        }

        init();
    </script>
</body>
</html>
